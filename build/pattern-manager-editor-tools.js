(()=>{"use strict";var e={n:t=>{var n=t&&t.__esModule?()=>t.default:()=>t;return e.d(n,{a:n}),n},d:(t,n)=>{for(var a in n)e.o(n,a)&&!e.o(t,a)&&Object.defineProperty(t,a,{enumerable:!0,get:n[a]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t)};const t=window.wp.plugins,n=window.wp.editor,a=window.wp.components,r=window.wp.i18n,s=window.wp.primitives,l=window.ReactJSXRuntime,o=(0,l.jsx)(s.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",children:(0,l.jsx)(s.Path,{d:"M14.103 7.128l2.26-2.26a4 4 0 00-5.207 4.804L5.828 15a2 2 0 102.828 2.828l5.329-5.328a4 4 0 004.804-5.208l-2.261 2.26-1.912-.512-.513-1.912zm-7.214 9.64a.5.5 0 11.707-.707.5.5 0 01-.707.707z"})}),i=(0,l.jsx)(s.SVG,{viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:(0,l.jsx)(s.Path,{d:"M20.8 10.7l-4.3-4.3-1.1 1.1 4.3 4.3c.1.1.1.3 0 .4l-4.3 4.3 1.1 1.1 4.3-4.3c.7-.8.7-1.9 0-2.6zM4.2 11.8l4.3-4.3-1-1-4.3 4.3c-.7.7-.7 1.8 0 2.5l4.3 4.3 1.1-1.1-4.3-4.3c-.2-.1-.2-.3-.1-.4z"})}),c=window.wp.element,d=window.wp.blockEditor,p=window.wp.blockSerializationDefaultParser,g=window.wp.apiFetch;var h=e.n(g);const m=class{name="";title="";description="";content="";categories=[];keywords=[];source="";synced=!1;inserter=!1;filePath=null;constructor(e){this.title=e.title||"",this.name=e.name,this.description=e.description||"",this.content=e.content||"",this.source=e.source||"",this.synced=e.synced||!1,this.inserter=e.inserter||!1,this.filePath=e.filePath||null}};async function x(){return h()({path:"/pattern-manager/v1/global-styles"}).then((e=>e)).catch((e=>{console.error("Error fetching global styles:",e)}))}const u=window.wp.blocks,_=({pattern:e,onClick:t})=>{const{title:n,content:r}=e,s=(0,u.parse)(r);return(0,l.jsxs)(a.Composite,{onClick:()=>{t&&t(e)},children:[(0,l.jsx)("p",{children:n}),(0,l.jsx)(d.BlockPreview,{blocks:s,viewportWidth:500})]})},j=({editorSettings:e,patterns:t,onFilterChange:n})=>{const[s,o]=(0,c.useState)({source:"all",synced:"both",category:"all",keyword:""}),i=(e,t)=>{const a={...s,[e]:t};o(a),n&&n(a)};return(0,l.jsx)("div",{className:"pattern-manager__sidebar",children:(0,l.jsxs)(a.PanelBody,{title:(0,r.__)("Filters","pattern-manager"),initialOpen:!0,children:[(0,l.jsx)(a.SelectControl,{label:(0,r.__)("Source","pattern-manager"),value:s.source,options:[{label:(0,r.__)("All","pattern-manager"),value:"all"},{label:(0,r.__)("User","pattern-manager"),value:"user"},{label:(0,r.__)("Theme","pattern-manager"),value:"theme"},{label:(0,r.__)("Core","pattern-manager"),value:"core"}],onChange:e=>i("source",e)}),(0,l.jsx)(a.SelectControl,{label:(0,r.__)("Synced","pattern-manager"),value:s.synced,options:[{label:(0,r.__)("All","pattern-manager"),value:"all"},{label:(0,r.__)("Synced","pattern-manager"),value:"yes"},{label:(0,r.__)("Unsynced","pattern-manager"),value:"no"}],onChange:e=>i("synced",e)}),(0,l.jsx)(a.SelectControl,{label:(0,r.__)("Categories","pattern-manager"),value:s.category,options:[{label:(0,r.__)("All Categories","pattern-manager"),value:"all"},{label:(0,r.__)("Category 1","pattern-manager"),value:"category1"},{label:(0,r.__)("Category 2","pattern-manager"),value:"category2"}],onChange:e=>i("category",e)}),(0,l.jsx)(a.TextControl,{label:(0,r.__)("Keyword","pattern-manager"),value:s.keyword,placeholder:(0,r.__)("Search by keyword...","pattern-manager"),onChange:e=>i("keyword",e)})]})})},w=({onPatternClick:e,patterns:t,editorSettings:n})=>(0,l.jsx)(d.BlockEditorProvider,{settings:{...n,isPreviewMode:!0,focusMode:!1},children:(0,l.jsx)("div",{className:"pattern-manager__preview-grid",children:t.map(((t,n)=>(0,l.jsx)("div",{className:"pattern-manager__preview-grid-item",children:(0,l.jsx)(_,{onClick:e,pattern:t})},n)))})}),v=({onPatternClick:e})=>{const[t,n]=(0,c.useState)([]),[a,s]=(0,c.useState)([]),[o,i]=(0,c.useState)({}),[d,p]=(0,c.useState)(!0),[g,u]=(0,c.useState)(null);return(0,c.useEffect)((()=>{(async function(){return h()({path:"/pattern-manager/v1/patterns",method:"GET",headers:{"Content-Type":"application/json"}}).then((e=>e.map((e=>new m(e)))))})().then((e=>{n(e),s(e),p(!1)})).catch((e=>{u(e.message||"Something went wrong."),p(!1)})),x().then((e=>{i(e)}))}),[]),(0,l.jsxs)("div",{className:"pattern-manager__pattern-browser",children:[d&&(0,l.jsx)("p",{children:(0,r.__)("Loading patterns...","pattern-manager")}),g&&(0,l.jsx)("p",{style:{color:"red"},children:g}),!d&&!g&&(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(w,{onPatternClick:e,patterns:a,editorSettings:o}),(0,l.jsx)(j,{patterns:t,editorSettings:o,onFilterChange:e=>{const{source:n}=e,a=t.filter((e=>"all"===n||e.source===n)).filter((t=>"all"===e.synced||t.synced===("yes"===e.synced)));s(a)}})]})]})},b=(0,l.jsx)(s.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",children:(0,l.jsx)(s.Path,{d:"M14.6 7l-1.2-1L8 12l5.4 6 1.2-1-4.6-5z"})}),y=({pattern:e,onChange:t})=>{const[n,r]=(0,c.useState)({...e}),s=(e,a)=>{r((t=>({...t,[e]:a}))),t&&t(n)};return(0,l.jsxs)("div",{className:"pattern-manager__pattern-details",children:[(0,l.jsx)(a.TextControl,{label:"Title",value:n.title||"",onChange:e=>s("title",e),__next40pxDefaultSize:!0,__nextHasNoMarginBottom:!0}),(0,l.jsx)(a.TextareaControl,{label:"Description",value:n.description||"",onChange:e=>s("description",e),__nextHasNoMarginBottom:!0}),(0,l.jsxs)("details",{children:[(0,l.jsx)("summary",{children:"Advanced"}),(0,l.jsx)("h3",{children:"Warning"}),(0,l.jsx)("p",{children:"The fields below are dangerous to change. Proceed with caution."}),(0,l.jsx)(a.TextControl,{label:"Slug",value:n.name||"",onChange:e=>s("name",e),__next40pxDefaultSize:!0,__nextHasNoMarginBottom:!0}),(0,l.jsxs)("div",{className:"components-base-control",children:[(0,l.jsx)("label",{className:"components-base-control__label",children:"Synced Pattern"}),(0,l.jsx)(a.ToggleControl,{checked:n.synced||!1,onChange:e=>s("synced",e),__nextHasNoMarginBottom:!0})]}),(0,l.jsx)(a.SelectControl,{label:"Source",value:n.source||"",options:[{label:"Core",value:"core",disabled:!0},{label:"Theme",value:"theme"},{label:"User",value:"user"}],onChange:e=>s("source",e),__nextHasNoMarginBottom:!0,__next40pxDefaultSize:!0})]})]})},C=({pattern:e,onClose:t})=>{const[r,s]=(0,c.useState)(e),[o,i]=(0,c.useState)((0,u.parse)(e.content)),[p,g]=(0,c.useState)(null);return(0,c.useEffect)((()=>{x().then((e=>{g(e)}))}),[]),p?(0,l.jsx)("div",{className:"pattern-manager__editor",children:(0,l.jsxs)(d.BlockEditorProvider,{value:o,onInput:i,onChange:i,settings:p,children:[(0,l.jsxs)("div",{className:"pattern-editor__header",children:[(0,l.jsx)(a.Button,{onClick:t,icon:b,label:"Back"}),(0,l.jsx)(a.ToolbarItem,{as:n.EditorHistoryUndo,variant:"tertiary",size:"compact"}),(0,l.jsx)(a.ToolbarItem,{as:n.EditorHistoryRedo,variant:"tertiary",size:"compact"}),(0,l.jsx)("div",{style:{flexGrow:1}}),(0,l.jsx)(a.Button,{variant:"primary",onClick:()=>{(async function(e){return h()({path:"/pattern-manager/v1/pattern",method:"PUT",body:JSON.stringify(e),headers:{"Content-Type":"application/json"}}).then((e=>new m(e)))})({...r,content:(0,u.serialize)(o)}).then((e=>{alert("Pattern saved successfully")})).catch((e=>{alert("Error saving pattern")}))},children:"Save"})]}),(0,l.jsxs)("div",{className:"pattern-editor__body",children:[(0,l.jsx)("div",{className:"pattern-editor__list-view",children:(0,l.jsx)(d.__experimentalListView,{})}),(0,l.jsx)("div",{className:"pattern-editor__content",children:(0,l.jsx)(d.BlockCanvas,{height:"100%"})}),(0,l.jsx)("div",{className:"pattern-editor__sidebar",children:(0,l.jsx)("div",{className:"pattern-sidebar",children:(0,l.jsx)(a.TabPanel,{className:"pattern-tabs",activeClass:"is-active",tabs:[{name:"pattern",title:"Pattern"},{name:"block",title:"Block"},{name:"add",title:"Add"},{name:"bindings",title:"Bindings"},{name:"history",title:"History"}],children:e=>(0,l.jsxs)(l.Fragment,{children:["pattern"===e.name&&(0,l.jsx)(a.Panel,{children:(0,l.jsx)(y,{pattern:r,onChange:s})}),"block"===e.name&&(0,l.jsx)(a.Panel,{children:(0,l.jsx)(d.BlockInspector,{})}),"add"===e.name&&(0,l.jsx)(a.Panel,{children:(0,l.jsx)(d.__experimentalLibrary,{})})]})})})})]})]})}):(0,l.jsx)("div",{className:"pattern-manager__editor",children:"Loading..."})},S=()=>{const[e,t]=(0,c.useState)(null);return(0,l.jsx)("div",{className:"pattern-manager__container",children:e?(0,l.jsx)(C,{pattern:e,onClose:()=>t(null)}):(0,l.jsx)(v,{onPatternClick:t})})},P=({onRequestClose:e})=>(0,l.jsx)(a.Modal,{title:(0,r._x)("Pattern Manager","UI String","pattern-manager"),className:"pattern-manager__modal",onRequestClose:e,isFullScreen:!0,children:(0,l.jsx)(S,{})});(0,t.registerPlugin)("pattern-manager",{render:function(){const[e,t]=(0,c.useState)(!1),s=(0,p.parse)("\x3c!-- wp:paragraph --\x3e<p>Hello from BlockPreview!</p>\x3c!-- /wp:paragraph --\x3e");return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(n.PluginSidebarMoreMenuItem,{target:"pattern-manager-sidebar",icon:o,onClick:()=>t(!0),children:(0,r._x)("Pattern Manager","UI String","pattern-manager")}),(0,l.jsxs)(n.PluginSidebar,{name:"pattern-manager-sidebar",icon:o,title:(0,r._x)("Pattern Manager","UI String","pattern-manager"),children:[(0,l.jsx)(a.Button,{icon:i,onClick:()=>t(!0),children:(0,r.__)("View Custom Styles","create-block-theme")}),(0,l.jsx)(d.BlockPreview,{blocks:s,viewportWidth:300,minHeight:300})]}),e&&(0,l.jsx)(P,{onRequestClose:()=>t(!1)})]})}})})();