(()=>{"use strict";var e={n:t=>{var n=t&&t.__esModule?()=>t.default:()=>t;return e.d(n,{a:n}),n},d:(t,n)=>{for(var a in n)e.o(n,a)&&!e.o(t,a)&&Object.defineProperty(t,a,{enumerable:!0,get:n[a]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t)};const t=window.wp.element,n=window.wp.i18n,a=window.wp.blockEditor,r=window.wp.apiFetch;var s=e.n(r);const l=class{name="";title="";description="";content="";categories=[];keywords=[];source="";synced=!1;inserter=!1;filePath=null;constructor(e){this.title=e.title||"",this.name=e.name,this.description=e.description||"",this.content=e.content||"",this.source=e.source||"",this.synced=e.synced||!1,this.inserter=e.inserter||!1,this.filePath=e.filePath||null}};async function o(){return s()({path:"/pattern-manager/v1/global-styles"}).then((e=>e)).catch((e=>{console.error("Error fetching global styles:",e)}))}const i=window.wp.blocks,c=window.wp.components,d=window.ReactJSXRuntime,p=({pattern:e,onClick:t})=>{const{title:n,content:r}=e,s=(0,i.parse)(r);return(0,d.jsxs)(c.Composite,{onClick:()=>{t&&t(e)},children:[(0,d.jsx)("p",{children:n}),(0,d.jsx)(a.BlockPreview,{blocks:s,viewportWidth:500})]})},h=({editorSettings:e,patterns:a,onFilterChange:r})=>{const[s,l]=(0,t.useState)({source:"all",synced:"both",category:"all",keyword:""}),o=(e,t)=>{const n={...s,[e]:t};l(n),r&&r(n)};return(0,d.jsx)("div",{className:"pattern-manager__sidebar",children:(0,d.jsxs)(c.PanelBody,{title:(0,n.__)("Filters","pattern-manager"),initialOpen:!0,children:[(0,d.jsx)(c.SelectControl,{label:(0,n.__)("Source","pattern-manager"),value:s.source,options:[{label:(0,n.__)("All","pattern-manager"),value:"all"},{label:(0,n.__)("User","pattern-manager"),value:"user"},{label:(0,n.__)("Theme","pattern-manager"),value:"theme"},{label:(0,n.__)("Core","pattern-manager"),value:"core"}],onChange:e=>o("source",e)}),(0,d.jsx)(c.SelectControl,{label:(0,n.__)("Synced","pattern-manager"),value:s.synced,options:[{label:(0,n.__)("All","pattern-manager"),value:"all"},{label:(0,n.__)("Synced","pattern-manager"),value:"yes"},{label:(0,n.__)("Unsynced","pattern-manager"),value:"no"}],onChange:e=>o("synced",e)}),(0,d.jsx)(c.SelectControl,{label:(0,n.__)("Categories","pattern-manager"),value:s.category,options:[{label:(0,n.__)("All Categories","pattern-manager"),value:"all"},{label:(0,n.__)("Category 1","pattern-manager"),value:"category1"},{label:(0,n.__)("Category 2","pattern-manager"),value:"category2"}],onChange:e=>o("category",e)}),(0,d.jsx)(c.TextControl,{label:(0,n.__)("Keyword","pattern-manager"),value:s.keyword,placeholder:(0,n.__)("Search by keyword...","pattern-manager"),onChange:e=>o("keyword",e)})]})})},m=({onPatternClick:e,patterns:t,editorSettings:n})=>(0,d.jsx)(a.BlockEditorProvider,{settings:{...n,isPreviewMode:!0,focusMode:!1},children:(0,d.jsx)("div",{className:"pattern-manager__preview-grid",children:t.map(((t,n)=>(0,d.jsx)("div",{className:"pattern-manager__preview-grid-item",children:(0,d.jsx)(p,{onClick:e,pattern:t})},n)))})}),g=({onPatternClick:e})=>{const[a,r]=(0,t.useState)([]),[i,c]=(0,t.useState)([]),[p,g]=(0,t.useState)({}),[u,_]=(0,t.useState)(!0),[x,v]=(0,t.useState)(null);return(0,t.useEffect)((()=>{(async function(){return s()({path:"/pattern-manager/v1/patterns",method:"GET",headers:{"Content-Type":"application/json"}}).then((e=>e.map((e=>new l(e)))))})().then((e=>{r(e),c(e),_(!1)})).catch((e=>{v(e.message||"Something went wrong."),_(!1)})),o().then((e=>{g(e)}))}),[]),(0,d.jsxs)("div",{className:"pattern-manager__pattern-browser",children:[u&&(0,d.jsx)("p",{children:(0,n.__)("Loading patterns...","pattern-manager")}),x&&(0,d.jsx)("p",{style:{color:"red"},children:x}),!u&&!x&&(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)(m,{onPatternClick:e,patterns:i,editorSettings:p}),(0,d.jsx)(h,{patterns:a,editorSettings:p,onFilterChange:e=>{const{source:t}=e,n=a.filter((e=>"all"===t||e.source===t)).filter((t=>"all"===e.synced||t.synced===("yes"===e.synced)));c(n)}})]})]})},u=window.wp.editor,_=window.wp.primitives,x=(0,d.jsx)(_.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",children:(0,d.jsx)(_.Path,{d:"M14.6 7l-1.2-1L8 12l5.4 6 1.2-1-4.6-5z"})}),v=({pattern:e,onChange:n})=>{const[a,r]=(0,t.useState)({...e}),s=(e,t)=>{r((n=>({...n,[e]:t}))),n&&n(a)};return(0,d.jsxs)("div",{className:"pattern-manager__pattern-details",children:[(0,d.jsx)(c.TextControl,{label:"Title",value:a.title||"",onChange:e=>s("title",e),__next40pxDefaultSize:!0,__nextHasNoMarginBottom:!0}),(0,d.jsx)(c.TextareaControl,{label:"Description",value:a.description||"",onChange:e=>s("description",e),__nextHasNoMarginBottom:!0}),(0,d.jsxs)("details",{children:[(0,d.jsx)("summary",{children:"Advanced"}),(0,d.jsx)("h3",{children:"Warning"}),(0,d.jsx)("p",{children:"The fields below are dangerous to change. Proceed with caution."}),(0,d.jsx)(c.TextControl,{label:"Slug",value:a.name||"",onChange:e=>s("name",e),__next40pxDefaultSize:!0,__nextHasNoMarginBottom:!0}),(0,d.jsxs)("div",{className:"components-base-control",children:[(0,d.jsx)("label",{className:"components-base-control__label",children:"Synced Pattern"}),(0,d.jsx)(c.ToggleControl,{checked:a.synced||!1,onChange:e=>s("synced",e),__nextHasNoMarginBottom:!0})]}),(0,d.jsx)(c.SelectControl,{label:"Source",value:a.source||"",options:[{label:"Core",value:"core",disabled:!0},{label:"Theme",value:"theme"},{label:"User",value:"user"}],onChange:e=>s("source",e),__nextHasNoMarginBottom:!0,__next40pxDefaultSize:!0})]})]})},j=({pattern:e,onClose:n})=>{const[r,p]=(0,t.useState)(e),[h,m]=(0,t.useState)((0,i.parse)(e.content)),[g,_]=(0,t.useState)(null);return(0,t.useEffect)((()=>{o().then((e=>{_(e)}))}),[]),g?(0,d.jsx)("div",{className:"pattern-manager__editor",children:(0,d.jsxs)(a.BlockEditorProvider,{value:h,onInput:m,onChange:m,settings:g,children:[(0,d.jsxs)("div",{className:"pattern-editor__header",children:[(0,d.jsx)(c.Button,{onClick:n,icon:x,label:"Back"}),(0,d.jsx)(c.ToolbarItem,{as:u.EditorHistoryUndo,variant:"tertiary",size:"compact"}),(0,d.jsx)(c.ToolbarItem,{as:u.EditorHistoryRedo,variant:"tertiary",size:"compact"}),(0,d.jsx)("div",{style:{flexGrow:1}}),(0,d.jsx)(c.Button,{variant:"primary",onClick:()=>{(async function(e){return s()({path:"/pattern-manager/v1/pattern",method:"PUT",body:JSON.stringify(e),headers:{"Content-Type":"application/json"}}).then((e=>new l(e)))})({...r,content:(0,i.serialize)(h)}).then((e=>{alert("Pattern saved successfully")})).catch((e=>{alert("Error saving pattern")}))},children:"Save"})]}),(0,d.jsxs)("div",{className:"pattern-editor__body",children:[(0,d.jsx)("div",{className:"pattern-editor__list-view",children:(0,d.jsx)(a.__experimentalListView,{})}),(0,d.jsx)("div",{className:"pattern-editor__content",children:(0,d.jsx)(a.BlockCanvas,{height:"100%"})}),(0,d.jsx)("div",{className:"pattern-editor__sidebar",children:(0,d.jsx)("div",{className:"pattern-sidebar",children:(0,d.jsx)(c.TabPanel,{className:"pattern-tabs",activeClass:"is-active",tabs:[{name:"pattern",title:"Pattern"},{name:"block",title:"Block"},{name:"add",title:"Add"},{name:"bindings",title:"Bindings"},{name:"history",title:"History"}],children:e=>(0,d.jsxs)(d.Fragment,{children:["pattern"===e.name&&(0,d.jsx)(c.Panel,{children:(0,d.jsx)(v,{pattern:r,onChange:p})}),"block"===e.name&&(0,d.jsx)(c.Panel,{children:(0,d.jsx)(a.BlockInspector,{})}),"add"===e.name&&(0,d.jsx)(c.Panel,{children:(0,d.jsx)(a.__experimentalLibrary,{})})]})})})})]})]})}):(0,d.jsx)("div",{className:"pattern-manager__editor",children:"Loading..."})},y=()=>{const[e,n]=(0,t.useState)(null);return(0,d.jsx)("div",{className:"pattern-manager__container",children:e?(0,d.jsx)(j,{pattern:e,onClose:()=>n(null)}):(0,d.jsx)(g,{onPatternClick:n})})};function w(){return(0,d.jsx)(y,{})}window.addEventListener("load",(function(){const e=document.getElementById("pattern-manager-app");(0,t.createRoot)(e).render((0,d.jsx)(w,{}))}),!1)})();